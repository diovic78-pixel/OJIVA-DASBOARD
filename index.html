<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Panel de Trazabilidad de Descarga de Buques</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #2355a4;
      --secondary: #3498db;
      --success: #27ae60;
      --danger: #e74c3c;
      --warning: #f39c12;
      --light: #f5f7fa;
      --white: #fff;
      --surface: #f9fbfd;
      --card: #e6eef7;
      --border: #dbe3eb;
      --kpi-bg: #fffbe7;
      --shadow: 0 2px 8px rgba(0,0,0,0.09);
      --radius: 14px;
      --radius-sm: 8px;
      --radius-xs: 6px;
    }
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: var(--light);
      margin: 0;
      color: #19324c;
    }
    header {
      background: linear-gradient(135deg,var(--primary), #102842 65%);
      color: var(--white);
      padding: 1.3rem 1.8rem;
      display: flex;
      align-items: center;
      box-shadow: var(--shadow);
      position: sticky; top: 0; z-index: 10;
    }
    header img {
      height: 48px;
      margin-right: 16px;
      border-radius: var(--radius-sm);
      background: #fff;
      box-shadow: 0 1px 8px #0002;
      padding:6px;
      object-fit: contain;
    }
    h1 {
      font-size:1.5rem;
      font-weight:700;
      margin-right:1.8rem;
      letter-spacing: 1px;
    }
    .header-icon {
      font-size:2.1rem;
      margin-right:10px;
      vertical-align: middle;
      color: var(--warning);
    }
    .container {
      max-width:1180px;
      margin:2rem auto;
      padding:1.2rem;
      background:var(--white);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    section {
      margin-bottom:2.4rem;
    }
    .modulo {
      padding:1.4rem 1rem;
      margin-bottom:2.4rem;
      border:1px solid var(--border);
      border-radius: var(--radius-sm);
      background: var(--surface);
      box-shadow: 0 2px 8px #0001;
    }
    .section-header {
      display: flex;
      align-items: center;
      margin-bottom:1.1rem;
    }
    .section-header i {
      font-size:1.5rem;
      margin-right:0.7rem;
      color: var(--primary);
    }
    .section-header h2 {
      margin:0; font-size:1.13rem; font-weight:600;
    }
    label {
      font-weight: 500; margin-right:5px;
    }
    input, select, button, textarea {
      margin-top:0.18rem; margin-bottom:0.57rem; padding:0.44rem;
      border-radius: var(--radius-xs); border:1px solid #ccd2db;
      font-size:1em;
      outline:none;
      transition: box-shadow 0.14s;
    }
    input:focus, select:focus, textarea:focus {
      box-shadow: 0 0 2px var(--primary);
      border-color: var(--primary);
    }
    button {
      background: var(--primary);
      color: var(--white);
      cursor: pointer;
      border: none; font-weight: 500;
      transition: background 0.2s,box-shadow 0.19s;
      display: inline-flex; align-items: center; gap:7px;
      box-shadow: 0 2px 6px #0001;
      border-radius:var(--radius-xs);
    }
    button i { font-size:1.14em;}
    button:hover {
      background: var(--secondary);
      box-shadow: 0 2px 10px #0002;
    }
    .icon-btn { background: none; color: var(--primary); border: 1px solid #ccd2db; }
    .icon-btn:hover { background: var(--primary); color: #fff; }
    table {
      width: 100%; border-collapse: collapse; margin-top: 0.5rem;
      background: var(--white); border-radius: var(--radius-xs); overflow:hidden;
      box-shadow: 0 2px 7px #0001;
    }
    th, td {
      border: 1px solid #c7d3e6;
      padding: 0.6rem;
      text-align: left;
      font-size:0.97em;
      background: var(--white);
    }
    th {
      background: #e7f0fa;
      font-weight: 600;
    }
    tr:hover td { background: #f0f8ff; }
    .flex-row {
      display: flex; gap: 1.5rem; flex-wrap: wrap;
    }
    .flex-col-2 { flex: 1 1 280px;}
    .summary {
      margin-top:0.9rem; background: #e1eaf6; padding:1rem;
      border-radius:8px; font-size: 1em;
      box-shadow: 0 1px 6px #0001;
    }
    .dashboard-card {
      background: var(--card);
      margin: 0.6rem 0;
      border-radius: var(--radius-xs);
      padding: 1.2rem 1.1rem;
      display: flex; align-items: center; gap: 13px;
      font-size: 1.02em; font-weight: 500;
      box-shadow: 0 2px 9px #00005a08;
    }
    .kpi-value {
      font-size:1.33em; font-weight:700; margin-left:7px;
      color: var(--success);
      letter-spacing: 1px;
    }
    .kpi-icon {
      font-size:1.71em; color: var(--primary);
      margin-right:7px;
    }
    .status-badge {
      padding:0.21em 0.7em; border-radius:6px;
      color:#fff; font-size:0.98em;
      display: inline-flex; align-items: center;
      gap:4px; font-weight:500;
    }
    .cargado { background: var(--success);}
    .no-cargado { background: var(--danger);}
    .status-badge i {font-size:1em;}
    .table-actions button {padding:0.19em 0.7em;}
    @media (max-width: 900px) {
      .container {padding:0.5rem;}
      .flex-row {flex-direction:column;}
      th, td {font-size:0.99em;}
      .dashboard-card {padding:0.9rem 0.7rem;}
    }
    @media (max-width:500px) {
      header {padding:1rem 0.3rem;}
      h1 {font-size:1rem;}
    }
  </style>
</head>
<body>
<header>
  <img src="image.jpg" alt="Logo" />
  <span class="header-icon"><i class="fas fa-ship"></i></span>
  <h1>Panel de Trazabilidad de Descarga de Buques</h1>
</header>
<div class="container">

  <!-- Información General -->
  <section class="modulo" id="mod-info-general">
    <div class="section-header"><i class="fas fa-ship"></i><h2>Información General del Buque</h2></div>
    <div class="flex-row">
      <div class="flex-col-2"><label><i class="fa fa-id-card"></i> Nombre:</label><input id="buque-nombre"></div>
      <div class="flex-col-2"><label><i class="fa fa-calendar"></i> ETA:</label><input type="datetime-local" id="buque-eta"></div>
      <div class="flex-col-2"><label><i class="fa fa-calendar-plus"></i> Fecha NOR:</label><input type="datetime-local" id="buque-nor"></div>
      <div class="flex-col-2"><label><i class="fa fa-tags"></i> Rata Contratada TM/día:</label><input type="number" id="buque-rata" min="1"></div>
    </div>
    <div class="flex-row">
      <div class="flex-col-2"><label><i class="fa fa-file-alt"></i> Condición Contrato:</label>
        <select id="buque-condicion">
          <option value="SHINC">SHINC</option>
          <option value="SHEX">SHEX</option>
        </select>
      </div>
      <div class="flex-col-2"><label><i class="fa fa-weight-scale"></i> Total Producto (TM):</label><input type="number" id="buque-tm" min="0"></div>
      <div class="flex-col-2"><label><i class="fa fa-play"></i> Inicio Operación:</label><input type="datetime-local" id="inicio-op"></div>
      <div class="flex-col-2"><label><i class="fa fa-stop"></i> Fin Operación:</label><input type="datetime-local" id="fin-op"></div>
    </div>
    <div class="summary" id="info-general-resumen">
      <div><b>Laytime Disponible:</b> <span id="laytime"></span></div>
      <div><b>Tiempo en Operación: </b><span id="tiempo-operacion"></span></div>
    </div>
  </section>

  <!-- Productos Manifestados -->
  <section class="modulo">
    <div class="section-header"><i class="fa fa-boxes"></i><h2>Productos Manifestados</h2></div>
    <div style="margin-bottom:1rem;">
      <label><i class="fa fa-plus-square"></i> Agregar Producto:</label>
      <div class="flex-row">
        <select id="nuevo-producto-tipo">
          <option value="">Seleccione producto...</option>
          <option value="Maíz Americano">Maíz Americano</option>
          <option value="Maíz Argentino">Maíz Argentino</option>
          <option value="Maíz Brasileño">Maíz Brasileño</option>
          <option value="DNS">DNS</option>
          <option value="HRW">HRW</option>
          <option value="SRW">SRW</option>
          <option value="Frijol">Frijol</option>
          <option value="Cascarilla">Cascarilla</option>
          <option value="Aceite de Palma">Aceite de Palma</option>
          <option value="Palmite">Palmite</option>
        </select>
        <select id="nuevo-producto-bodega">
          <option value="">Seleccione bodega...</option>
          <option value="1">Bodega 1</option>
          <option value="2">Bodega 2</option>
          <option value="3">Bodega 3</option>
          <option value="4">Bodega 4</option>
          <option value="5">Bodega 5</option>
          <option value="6">Bodega 6</option>
        </select>
        <button onclick="agregarProducto()"><i class="fa fa-plus-circle"></i> Agregar</button>
      </div>
    </div>
    <table id="tabla-productos">
      <thead>
        <tr>
          <th><i class="fa fa-box"></i> Producto</th>
          <th><i class="fa fa-warehouse"></i> Bodega</th>
          <th><i class="fa fa-clipboard-list"></i> Declarado (TM)</th>
          <th><i class="fa fa-truck-loading"></i> Descargado (TM)</th>
          <th><i class="fa fa-trash-alt"></i> Acción</th>
        </tr>
      </thead>
      <tbody id="tbody-productos"></tbody>
    </table>
  </section>

  <!-- Registro Paradas -->
  <section class="modulo">
    <div class="section-header"><i class="fa fa-clock"></i><h2>Registro de Paradas / Incidentes</h2></div>
    <form onsubmit="registrarParada(event)">
      <div class="flex-row">
        <div class="flex-col-2">
          <label><i class="fa fa-exclamation-triangle"></i> Motivo:</label>
          <select required id="parada-motivo">
            <option value="">Elija…</option>
            <option value="LLUVIA">LLUVIA</option>
            <option value="NO CAMIONES">NO CAMIONES</option>
            <option value="MOVIMIENTO BARCO">MOVIMIENTO BARCO</option>
            <option value="MECANIZADO FALLA">MECANIZADO FALLA</option>
            <option value="BUQUE INTERNO FALLA">BUQUE INTERNO FALLA</option>
            <option value="OTROS">OTROS</option>
          </select>
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-warehouse"></i> Bodega Afectada</label>
          <select id="bodega-afectada">
            <option value="1">Bodega 1</option>
            <option value="2">Bodega 2</option>
            <option value="3">Bodega 3</option>
            <option value="4">Bodega 4</option>
            <option value="5">Bodega 5</option>
            <option value="6">Bodega 6</option>
            <option value="Completo">Completo</option>
          </select>
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-play-circle"></i> Inicio:</label>
          <input required type="datetime-local" id="parada-inicio">
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-stop-circle"></i> Fin:</label>
          <input required type="datetime-local" id="parada-fin">
        </div>
        <div class="flex-col-2" style="align-self: flex-end;">
          <button type="submit"><i class="fa fa-plus"></i> Registrar</button>
        </div>
      </div>
    </form>
    <table id="tabla-paradas">
      <thead>
        <tr>
          <th><i class="fa fa-bolt"></i> Motivo</th>
          <th><i class="fa fa-warehouse"></i> Bodega</th>
          <th><i class="fa fa-play"></i> Inicio</th>
          <th><i class="fa fa-stop"></i> Fin</th>
          <th><i class="fa fa-history"></i> Duración (h:m)</th>
          <th><i class="fa fa-trash-alt"></i> Acción</th>
        </tr>
      </thead>
      <tbody id="tbody-paradas"></tbody>
    </table>
    <div class="summary"><b>Tiempo Total Paradas:</b> <span id="tiempo-paradas"></span></div>
  </section>

  <!-- Tracking de Camiones -->
  <section class="modulo">
    <div class="section-header"><i class="fa fa-truck"></i><h2>Tracking de Camiones</h2></div>
    <form onsubmit="registrarCamion(event)">
      <div class="flex-row">
        <div class="flex-col-2">
          <label><i class="fa fa-list-ol"></i> Listado:</label>
          <input required id="camion-nlistado" type="number" min="1">
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-id-badge"></i> Placa:</label>
          <input required id="camion-placa">
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-file-signature"></i> Ficha:</label>
          <input required id="camion-ficha">
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-clipboard-check"></i> Estatus:</label>
          <select id="camion-estatus">
            <option value="Cargado">Cargado</option>
            <option value="No Cargado">No Cargado</option>
          </select>
        </div>
        <div class="flex-col-2" style="align-self: flex-end;">
          <button type="submit"><i class="fa fa-save"></i> Registrar</button>
        </div>
      </div>
    </form>
    <div style="margin-bottom:0.7em;">
      <label><i class="fa fa-filter"></i> Filtrar por Estatus:</label>
      <select onchange="filtrarCamiones()" id="filtro-estatus">
        <option value="Todos">Todos</option>
        <option value="Cargado">Cargado</option>
        <option value="No Cargado">No Cargado</option>
      </select>
    </div>
    <table id="tabla-camiones">
      <thead>
        <tr>
          <th><i class="fa fa-list-ol"></i> Listado</th>
          <th><i class="fa fa-id-badge"></i> Placa</th>
          <th><i class="fa fa-file-signature"></i> Ficha</th>
          <th><i class="fa fa-clipboard-check"></i> Estatus</th>
          <th><i class="fa fa-trash-alt"></i> Acción</th>
        </tr>
      </thead>
      <tbody id="tbody-camiones"></tbody>
    </table>
    <div class="summary">
      <span><i class="fa fa-truck"></i> <b>Camiones registrados:</b> <span id="camion-total"></span></span>
      <span style="margin-left:25px;"><i class="fa fa-clock"></i> <b>Camiones por hora:</b> <span id="camion-xhora"></span></span>
    </div>
  </section>

  <!-- Correa Mecanizada -->
  <section class="modulo">
    <div class="section-header"><i class="fa fa-cogs"></i><h2>Correa Mecanizada (por hora)</h2></div>
    <form onsubmit="registrarCorrea(event)">
      <div class="flex-row">
        <div class="flex-col-2">
          <label><i class="fa fa-project-diagram"></i> Línea:</label>
          <select id="correa-linea">
            <option value="1">Línea 1</option>
            <option value="2">Línea 2</option>
          </select>
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-box"></i> Producto:</label>
          <input required id="correa-producto">
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-balance-scale-left"></i> Toneladas:</label>
          <input required type="number" id="correa-tn" min="1">
        </div>
        <div class="flex-col-2">
          <label><i class="fa fa-clock"></i> Hora:</label>
          <input required type="datetime-local" id="correa-hora">
        </div>
        <div class="flex-col-2" style="align-self: flex-end;">
          <button type="submit"><i class="fa fa-plus"></i> Registrar</button>
        </div>
      </div>
    </form>
    <table id="tabla-correa">
      <thead>
        <tr>
          <th><i class="fa fa-project-diagram"></i> Línea</th>
          <th><i class="fa fa-box"></i> Producto</th>
          <th><i class="fa fa-balance-scale-left"></i> Toneladas</th>
          <th><i class="fa fa-clock"></i> Hora</th>
          <th><i class="fa fa-trash-alt"></i> Acción</th>
        </tr>
      </thead>
      <tbody id="tbody-correa"></tbody>
    </table>
    <div class="summary">
      <b><i class="fa fa-box"></i> Total Descargado por Correa:</b> <span id="total-correa"></span> TM
    </div>
  </section>

  <!-- Toneladas Camiones y Dashboard -->
  <section class="modulo">
    <div class="section-header"><i class="fa fa-chart-bar"></i><h2>Dashboard y Resumen Ejecutivo</h2></div>
    <div class="dashboard-card"><i class="fa fa-truck kpi-icon"></i> <span><b>Descarga Camión:</b> <span class="kpi-value" id="dsh-tot-camion"></span></span></div>
    <div class="dashboard-card"><i class="fa fa-cogs kpi-icon"></i> <span><b>Descarga Mecanizado:</b> <span class="kpi-value" id="dsh-tot-mec"></span></span></div>
    <div class="dashboard-card"><i class="fa fa-layer-group kpi-icon"></i> <span><b>Total Global:</b> <span class="kpi-value" id="dsh-tot-total"></span></span></div>
    <div class="dashboard-card"><i class="fa fa-clock kpi-icon"></i> <span><b>Tiempo Bruto Operación:</b> <span class="kpi-value" id="dsh-tiempo-bruto"></span></span></div>
    <div class="dashboard-card"><i class="fa fa-stopwatch kpi-icon"></i> <span><b>Tiempo Neto Operación:</b> <span class="kpi-value" id="dsh-tiempo-neto"></span></span></div>
    <div class="dashboard-card"><i class="fa fa-chart-line kpi-icon"></i> <span><b>TPH Promedio (bruto/neto):</b> <span class="kpi-value" id="dsh-tph"></span></span></div>
    <div class="dashboard-card"><i class="fa fa-calendar-minus kpi-icon"></i> <span><b>Laytime Hábil Restante:</b> <span class="kpi-value" id="dsh-laytime-rest"></span></span></div>
    <div class="dashboard-card"><label><b>Gráfica Descarga por Hora:</b></label>
      <canvas id="grafico-horas" height="120"></canvas>
    </div>
    <div class="dashboard-card"><input type="file" id="import-camiones" accept=".xlsx,.xls"/>
      <button onclick="limpiarTonCamiones()" type="button" class="icon-btn"><i class="fa fa-trash"></i> Limpiar datos</button>
      <label style="display:block;margin:12px 0 0 0;"><i class="fa fa-balance-scale-right"></i> Toneladas mecanizado (+): <input id="toneladas-mec" type="number" min="0" value="0" style="width:90px;display:inline;" onchange="actualizarTotalToneladas()"></label>
      <div id="res-ton-camiones"></div>
      <canvas id="grafico-ton" height="120"></canvas>
    </div>
  </section>
</div>
<!-- Insert your improved JS here; JS code structure can be reused from your current solution for all calculations and rendering -->
<script>
// ... JS igual que antes, puedes copiar el script de tu versión anterior aquí, ¡funcionará con los nuevos estilos y estructura!
</script>
</body>
</html>
